#!/bin/bash

# Initial setup so that squire may manage its own libraries
function squire_enable() {
  BASHLIBPATH=${BASHLIBPATH:="~/.local/lib/:$(readlink -m ${BASH_SOURCE}/../../lib)"}

  library_directories=$(echo $BASHLIBPATH|tr ':' ' ')
  for library_directory in $library_directories ; do
    squire_library="${library_directory%\/}/squire.sh"
    if [[ -f $squire_library ]]; then
      source $squire_library
      echo "Squire sourced: $squire_library"
    fi
  done
}

function squire_disable() {
  unset BASHLIBPATH
}

case "$1" in
  --enable|-e )
    squire_enable
    echo 'Squire enabled.'
    ;;
  --disable|-d )
    squire_disable
    echo 'Squire disabled.'
    ;;
  --version|-v )
    squire_enable
    echo $APPLICATION_NAME $VERSION
    ;;
  * )
    cat << USAGE
    squire <(--enabled|-e)|(--disabled|-d)|(--version|-v)>
USAGE
    ;;
esac
